- name: Update Check Point Firewall
  hosts: localhost
  connection: local
  gather_facts: no
  vars_files:
    - ../vars/main.yml
  tasks:
    - name: Add Firewall Rule
      check_point.mgmt.cp_mgmt_access_rule:
        name: "Allow HTTP"
        layer: "Network"
        position: "top"
        source: "Any"
        destination: "Any"
        service: "http"
        action: "Accept"
        auto_publish_session: true
        server: "{{ mgmt_server }}"
        username: "{{ mgmt_username }}"
        password: "{{ mgmt_password }}"
      register: result

    - name: Debug Output
      debug:
        var: result